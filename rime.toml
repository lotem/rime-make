[config]
min_version = "0.30.6"
additional_profiles = ["ibus-rime", "fcitx-rime", "weasel", "squirrel"]

[env]

[env.ibus-rime]

[env.fcitx-rime]

[env.weasel]

[env.squirrel]

# This task overrides the predefined |default| cargo-make task.
[tasks.default]
clear = true
run_task = "deploy"

# Deploys Rime data files.
# By default, copy the output of a successful build to $RIME_USER_DATA_DIR.
[tasks.deploy]
command = "echo"
args = ["Deploying workspace"]
dependencies = ["build"]

[tasks.build]
clear = true
command = "echo"
args = ["Building workspace"]
dependencies = ["update-workspace"]

[tasks.update-workspace]
dependencies = ["init-workspace"]
run_task = "fill-prescription"

# Initializes a Rime user's workspace.
# This task is for operations that have to be done before taking Rime recipes.
# For example, to clone user's personal configuration from a Git repository.
[tasks.init-workspace]
command = "echo"
args = ["Initializing workspace"]

# task.recipes to be defined in user.toml
[tasks.fill-prescription]
run_task = "recipes"

# Standard procedure to take a recipe.
[tasks.recipe]
run_task = { "name" = [
  "download-recipe",
  "install-recipe",
  "test-recipe",
] }

[tasks.download-recipe]
command = "echo"
args = ["Downloading ${RECIPE} from ${GIT_REPO}"]

[tasks.install-recipe]
command = "echo"
args = ["Installing ${RECIPE}"]

[tasks.test-recipe]
command = "echo"
args = ["Testing ${RECIPE}"]

[tasks.customize]
command = "echo"
args = ["Customizing ${TARGET}"]
